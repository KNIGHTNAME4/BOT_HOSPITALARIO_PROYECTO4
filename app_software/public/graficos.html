<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <title>GrÃ¡ficos del PDF</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body { background:#f8f9fa; }
    .card { border-radius:15px; box-shadow:0 4px 12px rgba(0,0,0,0.08); }
    .btn-regresar { font-weight:600; padding:10px 22px; border-radius:50px; }
  </style>
</head>
<body class="container py-5">

  <h2 class="text-center mb-3">ðŸ“Š GrÃ¡ficos generados del PDF</h2>
  <p class="text-center">Hola <b>{{ username }}</b></p>

  <div class="card p-3 mb-4">
    <h5>ðŸ“– Extracto del PDF</h5>
    <p>{{ pdf_text[:500] }}{% if pdf_text|length > 500 %}...{% endif %}</p>
  </div>

  <div class="card p-4 mb-4">
    <canvas id="graficoPDF" height="120"></canvas>
  </div>

  <div class="text-center">
    <a href="{{ url_for('dashboard') }}" class="btn btn-secondary btn-regresar">â¬… Volver al Dashboard</a>
  </div>

  <script>
    // Reemplaza esto por datos reales si no usas un motor de plantillas
    const chartData = {
      labels: ["Ejemplo 1", "Ejemplo 2", "Ejemplo 3"],
      values: [10, 20, 30]
    };
    // Si usas un motor de plantillas como Flask/Jinja2, asegÃºrate de que chart_data estÃ© definido en el backend
    // const chartData = {{ chart_data|tojson }};
    const labels = chartData.labels || [];
    const values = chartData.values || [];

    const ctx = document.getElementById('graficoPDF').getContext('2d');
    const graficoPDF = new Chart(ctx, {
      type: 'doughnut',
      data: {
        labels: labels,
        datasets: [{
          label: 'EstadÃ­sticas del PDF',
          data: values,
          backgroundColor: [
            'rgba(75,192,192,0.8)',
            'rgba(153,102,255,0.8)',
            'rgba(255,159,64,0.8)'
          ],
          borderColor: '#fff',
          borderWidth: 2
        }]
      },
      options: {
        plugins: {
          legend: { position: 'bottom', labels: { font: { size: 14 } } }
        }
      }
    });
  </script>
</body>
</html>

